package main

import (
    "time"
)

var (
    programCounter int
    // clockspeed, _ = time.ParseDuration("559ns") // 1.79Mhz
    clockspeed, _ = time.ParseDuration("10ms") // 1.79Mhz
)

func main() {
    cpu := new(Cpu)

    // decrement8bit := []Word{0xa2, 0xff, 0xca, 0xd0, 0xfd, 0x60,}
    // decrement16bit := []Word{0xa0, 0xff, 0xa2, 0xff, 0xca, 0xd0, 0xfd, 0x88, 0xd0, 0xf8, 0x60,}
    /*
    test3 := []Word{0xa0, 0x00, 0xb1, 0x30, 0xaa, 0xa5, 0x2f, 0xc8,
                    0xd1, 0x30, 0xf0, 0x04, 0xca, 0xd0, 0xf8, 0x60,
                    0xca, 0xf0, 0x0a, 0xc8, 0xb1, 0x30, 0x88, 0x91,
                    0x30, 0xc8, 0x4c, 0x10, 0x06, 0xa1, 0x30, 0xe9,
                    0x01, 0x81, 0x30, 0x60,}
    */

    test4 := []Word{0xA9, 0x0F, 0x8D, 0x00, 0x00, 0xA9, 0x04, 0x8D,
                    0x01, 0x00, 0xA9, 0x01, 0x8D, 0x02, 0x00, 0xAD,
                    0x00, 0x00, 0x8D, 0x03, 0x00, 0xAD, 0x01, 0x00,
                    0x8D, 0x04, 0x00, 0xAD, 0x02, 0x00, 0xC9, 0x00,
                    0xD0, 0x06, 0xEE, 0x00, 0x00, 0x4C, 0x2B, 0x00,
                    0xCE, 0x00, 0x00, 0xAE, 0x02, 0x00, 0xAD, 0x00,
                    0x00, 0xC9, 0x1F, 0xD0, 0x05, 0xA2, 0x01, 0x4C,
                    0x40, 0x00, 0xC9, 0x00, 0xD0, 0x02, 0xA2, 0x00,
                    0x8E, 0x02, 0x00, 0xA9, 0x01, 0xA2, 0x00, 0x81,
                    0x00, 0xA9, 0x00, 0xA2, 0x00, 0x81, 0x03, 0x4C,
                    0x0F, 0x00,}

    program := test4

    for index,value := range program {
        memory[index] = value
    }

    for programCounter < len(program) {
        cpu.Step()
        time.Sleep(clockspeed)
    }

    return
}
